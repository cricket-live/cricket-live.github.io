<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live Cricket Score - YouTube Overlay</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', 'Arial', sans-serif;
            background: transparent;
            overflow-x: hidden;
            width: 100%;
            height: 100vh;
        }

        /* Main Container - Fixed Position for YouTube */
        .overlay-container {
            position: fixed;
            bottom: 50%;
            right: 50%;
            transform: translate(50%, 50%);
            width: 360px;
            background: linear-gradient(135deg, rgba(10, 20, 40, 0.96) 0%, rgba(5, 30, 50, 0.96) 100%);
            border-radius: 28px;
            padding: 14px 16px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.85), inset 0 1px 0 rgba(255, 255, 255, 0.08);
            -webkit-backdrop-filter: blur(12px);
            backdrop-filter: blur(12px);
            border: 1.5px solid rgba(16, 185, 129, 0.35);
            z-index: 9999;
            max-height: 85vh;
            overflow-y: auto;
        }

        /* Scrollbar styling for mobile */
        .overlay-container::-webkit-scrollbar {
            width: 4px;
        }

        .overlay-container::-webkit-scrollbar-track {
            background: rgba(5, 150, 105, 0.1);
            border-radius: 10px;
        }

        .overlay-container::-webkit-scrollbar-thumb {
            background: rgba(5, 150, 105, 0.4);
            border-radius: 10px;
        }

        /* Header */
        .bottom-section {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 8px;
            width: 100%;
            align-items: stretch;
        }

        .batting-info,
        .bowling-info {
            min-width: 0;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            background: rgba(20, 45, 70, 0.5);
            border-radius: 12px;
            padding: 10px 9px;
            border: 1px solid rgba(16, 185, 129, 0.25);
        }

        .center-score {
            text-align: center;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background: rgba(20, 45, 70, 0.5);
            border-radius: 12px;
            padding: 10px 8px;
            border: 1px solid rgba(16, 185, 129, 0.25);
        }

        .section-title {
            color: #10b981;
            font-size: 10px;
            font-weight: 800;
            text-transform: uppercase;
            margin-bottom: 4px;
            letter-spacing: 0.8px;
            line-height: 1;
            background: linear-gradient(135deg, #10b981, #059669);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .batting-team-center {
            font-size: 10px;
            color: rgba(255, 255, 255, 0.85);
            margin-bottom: 2px;
            font-weight: 700;
            line-height: 1;
            letter-spacing: 0.3px;
        }

        .score-center {
            font-size: 36px;
            font-weight: 900;
            color: #10b981;
            text-shadow: 0 2px 8px rgba(16, 185, 129, 0.3);
            line-height: 0.9;
            margin-bottom: 2px;
            word-break: break-word;
            font-variant-numeric: tabular-nums;
        }

        .overs-center {
            font-size: 11px;
            color: rgba(16, 185, 129, 0.95);
            font-weight: 700;
            margin-bottom: 1px;
            line-height: 1;
            letter-spacing: 0.2px;
        }

        .crr-center {
            font-size: 9px;
            color: rgba(255, 255, 255, 0.75);
            margin-bottom: 0px;
            line-height: 1;
        }

        .crr-value-text {
            color: #10b981;
            font-weight: 700;
        }

        .vs-tag {
            font-size: 9px;
            color: #10b981;
            font-weight: bold;
            margin-bottom: 1px;
            line-height: 1;
        }

        .live-wrapper {
            margin-top: 0px;
        }

        .live-badge {
            background: #ef4444;
            color: white;
            padding: 1px 4px;
            border-radius: 2px;
            font-size: 7px;
            font-weight: bold;
            animation: pulse 1.5s infinite;
            display: inline-block;
            line-height: 1;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .batsman-row {
            margin-bottom: 3px;
            color: #fff;
            word-break: break-word;
            line-height: 1.1;
        }

        .batsman-name {
            font-size: 9px;
            font-weight: 700;
            margin-bottom: 0px;
            display: flex;
            align-items: center;
            gap: 2px;
            flex-wrap: wrap;
            line-height: 1.1;
        }

        .striker-indicator {
            color: #10b981;
            font-size: 10px;
            flex-shrink: 0;
        }

        .striker-hidden {
            opacity: 0;
            width: 0;
            margin: 0;
        }

        .batsman-stats {
            font-size: 8px;
            color: #10b981;
            font-weight: 600;
            line-height: 1;
        }

        .bowler-info-text {
            color: #fff;
        }

        .bowler-name {
            font-size: 9px;
            font-weight: 700;
            margin-bottom: 2px;
            word-break: break-word;
            line-height: 1.1;
        }

        .bowler-stats {
            font-size: 8px;
            color: #ef4444;
            font-weight: 600;
            line-height: 1.2;
        }

        /* Responsive Design - Desktop */
        @media (max-width: 1280px) {
            .overlay-container {
                width: 360px;
                padding: 11px 13px;
                border-radius: 28px;
            }
            .score-center {
                font-size: 34px;
            }
            .bottom-section {
                gap: 8px;
            }
            .batting-info, .center-score, .bowling-info {
                padding: 10px 9px;
            }
        }

        /* Tablet */
        @media (max-width: 1024px) {
            .overlay-container {
                width: 340px;
                padding: 12px 14px;
                border-radius: 26px;
            }
            .bottom-section {
                gap: 8px;
            }
            .batting-info, .center-score, .bowling-info {
                padding: 10px 8px;
            }
            .score-center {
                font-size: 30px;
            }
            .section-title {
                font-size: 9px;
            }
            .striker-name, .bowler-name {
                font-size: 11px;
            }
        }

        /* iPad/Large Mobile */
        @media (max-width: 768px) {
            .overlay-container {
                width: 340px;
                padding: 12px 14px;
                border-radius: 24px;
                bottom: 50%;
                right: 50%;
                transform: translate(50%, 50%);
                position: fixed;
            }
            .bottom-section {
                grid-template-columns: 1fr 1fr 1fr;
                gap: 8px;
            }
            .center-score {
                border: 1px solid rgba(16, 185, 129, 0.25);
                padding: 10px 8px;
            }
            .batting-info,
            .bowling-info {
                padding: 8px 7px;
            }
            .score-center {
                font-size: 28px;
            }
            .section-title {
                font-size: 9px;
                margin-bottom: 3px;
            }
            .batsman-row {
                margin-bottom: 3px;
            }
            .overs-center {
                font-size: 10px;
                margin-bottom: 1px;
            }
            .batting-team-center {
                font-size: 9px;
                margin-bottom: 1px;
            }
            .striker-name,
            .bowler-name {
                font-size: 10px;
            }
            .striker-stats,
            .bowler-stats {
                font-size: 8px;
            }
            .batsman-stats {
                font-size: 8px;
            }
        }

        /* Mobile - Medium (480px - 640px) */
        @media (max-width: 640px) {
            .overlay-container {
                width: 320px;
                padding: 11px 13px;
                border-radius: 22px;
                bottom: 50%;
                right: 50%;
                transform: translate(50%, 50%);
                position: fixed;
            }
            .bottom-section {
                grid-template-columns: 1fr 1fr 1fr;
                gap: 7px;
            }
            .center-score {
                border: 1px solid rgba(16, 185, 129, 0.25);
                padding: 8px 6px;
            }
            .batting-info, .bowling-info {
                padding: 7px 6px;
            }
            .score-center {
                font-size: 26px;
            }
            .section-title {
                font-size: 8px;
                margin-bottom: 2px;
            }
            .batsman-name,
            .bowler-name {
                font-size: 9px;
            }
            .batsman-stats,
            .bowler-stats {
                font-size: 7px;
            }
            .overs-center {
                font-size: 8px;
                margin-bottom: 1px;
            }
            .batting-team-center {
                font-size: 8px;
                margin-bottom: 1px;
            }
            .crr-center {
                font-size: 7px;
            }
            .batsman-row {
                margin-bottom: 2px;
            }
            .live-badge {
                font-size: 7px;
                padding: 2px 5px;
            }
            .vs-tag {
                font-size: 7px;
                margin-bottom: 1px;
            }
        }

        /* Mobile - Small (max 480px) */
        @media (max-width: 480px) {
            body {
                margin: 0;
                padding: 0;
            }

            .overlay-container {
                width: 300px;
                padding: 10px 12px;
                border-radius: 20px;
                bottom: 50%;
                right: 50%;
                transform: translate(50%, 50%);
                position: fixed;
                max-height: 93vh;
            }
            
            .bottom-section {
                grid-template-columns: 1fr 1fr 1fr;
                gap: 6px;
            }
            
            .center-score {
                border: 1px solid rgba(16, 185, 129, 0.25);
                padding: 6px 5px;
            }
            
            .batting-info, .bowling-info {
                padding: 6px 5px;
            }
            
            .score-center {
                font-size: 24px;
                margin: 0px;
            }
            
            .section-title {
                font-size: 7px;
                margin-bottom: 2px;
            }
            
            .batsman-name,
            .bowler-name {
                font-size: 8px;
            }
            
            .batsman-stats,
            .bowler-stats {
                font-size: 6px;
            }
            
            .overs-center {
                font-size: 7px;
                margin-bottom: 1px;
            }
            
            .batting-team-center {
                font-size: 7px;
                margin-bottom: 1px;
            }
            
            .crr-center {
                font-size: 6px;
            }
            
            .batsman-row {
                margin-bottom: 1px;
            }
            
            .live-badge {
                padding: 1px 4px;
                font-size: 6px;
            }
            
            .vs-tag {
                font-size: 6px;
                margin-bottom: 1px;
            }
            
            .striker-indicator {
                font-size: 7px;
            }
        }
        .live-wrapper {
            margin-top: 0px;
        }

        /* Extra Small Mobile (below 360px) */
        @media (max-width: 360px) {
            .overlay-container {
                padding: 6px 7px;
                bottom: 4px;
                right: 4px;
                left: 4px;
                border-radius: 5px;
                width: 92vw;
            }

            .score-center {
                font-size: 18px;
                padding: 0px 0;
                margin: 0px 0;
            }

            .section-title {
                font-size: 6px;
                margin-bottom: 1px;
            }

            .batsman-name,
            .bowler-name {
                font-size: 6px;
            }

            .batsman-stats,
            .bowler-stats {
                font-size: 5px;
            }

            .overs-center {
                font-size: 7px;
                margin-bottom: 0px;
            }

            .batting-team-center {
                font-size: 6px;
                margin-bottom: 0px;
            }

            .crr-center {
                font-size: 5px;
            }

            .batsman-row {
                margin-bottom: 1px;
            }
            
            .live-badge {
                padding: 1px 2px;
                font-size: 5px;
            }
            
            .vs-tag {
                font-size: 6px;
            }
        }
    </style>
</head>
<body>
    <div class="overlay-container">
                
                <!-- BOTTOM SECTION - Player Info Bar -->
                <div class="bottom-section">
                    
                    <!-- LEFT - Batting Info -->
                    <div class="batting-info">
                        <div class="section-title" id="battingTeamTitle">TEAM A - BATTING</div>
                        
                        <!-- Striker -->
                        <div class="batsman-row">
                            <div class="batsman-name">
                                <span class="striker-indicator" id="striker1">★</span>
                                <span id="strikerName">Player 1</span>
                            </div>
                            <div class="batsman-stats">
                                <span id="strikerRuns">0</span> (<span id="strikerBalls">0</span>)
                            </div>
                        </div>

                        <!-- Non-Striker -->
                        <div class="batsman-row">
                            <div class="batsman-name">
                                <span class="striker-indicator striker-hidden" id="striker2">★</span>
                                <span id="nonStrikerName">Player 2</span>
                            </div>
                            <div class="batsman-stats">
                                <span id="nonStrikerRuns">0</span> (<span id="nonStrikerBalls">0</span>)
                            </div>
                        </div>
                    </div>

                    <!-- CENTER - Score Section -->
                    <div class="center-score">
                        <div class="vs-tag">VS</div>
                        <div id="battingTeam" class="batting-team-center">TEAM A BATTING</div>
                        <div id="scoreDisplay" class="score-center">0/0</div>
                        <div id="oversDisplay" class="overs-center">Overs: 0.0</div>
                        <div class="crr-center">
                            <span class="crr-label">CRR: </span>
                            <span id="crrValue" class="crr-value-text">0.00</span>
                        </div>
                        <div class="live-wrapper">
                            <div class="live-badge live-inline">● LIVE</div>
                        </div>
                    </div>

                    <!-- RIGHT - Bowling Info -->
                    <div class="bowling-info">
                        <div class="section-title" id="bowlingTeamTitle">TEAM B - BOWLING</div>
                        <div class="bowler-info-text">
                            <div id="bowlerName" class="bowler-name">Bowler 1</div>
                            <div class="bowler-stats">
                                <div><span id="bowlerOvers">0.0</span> Overs</div>
                                <div><span id="bowlerRuns">0</span> Runs</div>
                                <div><span id="bowlerWickets">0</span> Wickets</div>
                            </div>
                        </div>
                    </div>

        </div>
    </div>

    <!-- Firebase SDK v12+ (Modular) -->
    <script type="module">
        // Import Firebase modules
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/12.8.0/firebase-app.js';
        import { getDatabase, ref, onValue } from 'https://www.gstatic.com/firebasejs/12.8.0/firebase-database.js';

        // ============================================
        // FIREBASE CONFIG
        // ============================================
        const firebaseConfig = {
            apiKey: "AIzaSyCgS_M3ag8piR9Osui5zc3t0xMM_0HMZSI",
            authDomain: "cricket-2790a.firebaseapp.com",
            databaseURL: "https://cricket-2790a-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "cricket-2790a",
            storageBucket: "cricket-2790a.appspot.com",
            messagingSenderId: "145576359225",
            appId: "1:145576359225:web:4bc43bb21a0c1d44d364e8",
            measurementId: "G-VHYQQN441W"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);

        // Reference to the match data in database
        const matchRef = ref(database, 'match');

        // Calculate Current Run Rate
        function calculateCRR(runs, overs) {
            const oversFloat = parseFloat(overs) || 0;
            if (oversFloat === 0) return "0.00";
            
            // Convert overs to total balls (e.g., 10.2 = 10 overs + 2 balls = 62 balls)
            const wholeOvers = Math.floor(oversFloat);
            const balls = Math.round((oversFloat - wholeOvers) * 10);
            const totalBalls = (wholeOvers * 6) + balls;
            const totalOvers = totalBalls / 6;
            
            const crr = runs / totalOvers;
            return crr.toFixed(2);
        }

        // Listen for real-time updates from Firebase
        // This triggers instantly when data changes
        onValue(matchRef, (snapshot) => {
            if (!snapshot.exists()) {
                return;
            }

            const data = snapshot.val();

            // Team mapping: batting flag (TEAM A/TEAM B) -> actual names
            const teamA = data.teamA || 'TEAM A';
            const teamB = data.teamB || 'TEAM B';
            const battingFlag = (data.batting || 'TEAM A').toUpperCase();
            const battingTeam = battingFlag === 'TEAM B' ? teamB : teamA;
            const bowlingTeam = battingTeam === teamA ? teamB : teamA;

            // Update section titles with team names
            document.getElementById('battingTeamTitle').textContent = `${battingTeam.toUpperCase()} - BATTING`;
            document.getElementById('bowlingTeamTitle').textContent = `${bowlingTeam.toUpperCase()} - BOWLING`;

            // Update batting team indicator
            document.getElementById('battingTeam').textContent = `${battingTeam.toUpperCase()} BATTING`;

            // Update main score
            const runs = data.score?.runs || 0;
            const wickets = data.score?.wickets || 0;
            const overs = data.score?.overs || '0.0';

            document.getElementById('scoreDisplay').textContent = `${runs}/${wickets}`;
            document.getElementById('oversDisplay').textContent = `Overs: ${overs}`;

            // Update striker batsman
            const striker = data.batsmen?.striker || {};
            document.getElementById('strikerName').textContent = striker.name || 'Player 1';
            document.getElementById('strikerRuns').textContent = striker.runs || 0;
            document.getElementById('strikerBalls').textContent = striker.balls || 0;

            // Update non-striker batsman
            const nonStriker = data.batsmen?.nonStriker || {};
            document.getElementById('nonStrikerName').textContent = nonStriker.name || 'Player 2';
            document.getElementById('nonStrikerRuns').textContent = nonStriker.runs || 0;
            document.getElementById('nonStrikerBalls').textContent = nonStriker.balls || 0;

            // Update bowler
            const bowler = data.bowler || {};
            document.getElementById('bowlerName').textContent = bowler.name || 'Bowler 1';
            document.getElementById('bowlerOvers').textContent = bowler.overs || '0.0';
            document.getElementById('bowlerRuns').textContent = bowler.runs || 0;
            document.getElementById('bowlerWickets').textContent = bowler.wickets || 0;

            // Calculate and update CRR
            const crr = calculateCRR(runs, overs);
            document.getElementById('crrValue').textContent = crr;
        });

        console.log('✅ OBS Overlay connected to Firebase - Real-time updates active');
    </script>
</body>
</html>
